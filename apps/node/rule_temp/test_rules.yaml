groups:
  # 报警组组名称
  - name: hostStatsAlert
    #报警组规则
    rules:
      #告警名称，需唯一
      - alert: hostCpuUsageAlert
        #promQL表达式
        expr: ((sum(avg without (cpu)(irate(node_cpu_seconds_total{mode!='idle'}[5m]))) by (instance)) * 1000) > 5
        #满足此表达式持续时间超过for规定的时间才会触发此报警
        for: 5s
        labels:
          #严重级别
          severity: page
        annotations:
          #发出的告警标题
          summary: '{\"call\": [],\"sms\": [],\"emails\": [],\"cc\": [], \"wechat\": [\"biao.hu\"],\"webhooks\": []}'
          #发出的告警内容
          description: '实例{{ $labels.instance }}({{ $labels.endpoint }})CPU使用率超过10%(当前值为: {{ $value }})'
      # - alert: PrometheusAllTargetsMissing
      #   expr: count by (job) (up) > 0
      #   for: 0m
      #   labels:
      #     severity: critical
      #   annotations:
      #     summary: Prometheus all targets missing (instance {{ $labels.instance }})
      #     description: "A Prometheus job does not have living target anymore.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

      # - alert: PrometheusTargetMissing
      #   expr: up > 0
      #   for: 0m
      #   labels:
      #     severity: critical
      #   annotations:
      #     summary: Prometheus target missing (instance {{ $labels.instance }})
      #     description: "A Prometheus target has disappeared. An exporter might be crashed.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

      # - alert: PrometheusConfigurationReloadFailure
      #   expr: prometheus_config_last_reload_successful > 0
      #   for: 0m
      #   labels:
      #     severity: warning
      #   annotations:
      #     summary: Prometheus configuration reload failure (instance {{ $labels.instance }})
      #     description: "Prometheus configuration reload error\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
